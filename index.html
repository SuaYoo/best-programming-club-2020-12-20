<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Farmer's Market</title>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script
      src="https://unpkg.com/react@17/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"
      crossorigin
    ></script>
  </head>
  <body>
    <header>
      <h1>Farmer's Market</h1>
    </header>

    <main id="app-root"></main>

    <script type="text/babel">
      const availableProductsData = {
        fruit: [
          {
            product: 'Apple',
            price: '0.40',
          },
          {
            product: 'Banana',
            price: '0.20',
          },
        ],
        vegetables: [
          {
            product: 'Broccoli (per pound)',
            price: '0.80',
          },
          {
            product: 'Squash',
            price: '1.00',
          },
          {
            product: 'Carrot',
            price: '0.30',
          },
        ],
      }

      class App extends React.Component {
        constructor(props) {
          super(props)

          this.state = {
            itemsInCart: [],
            cartTotal: 0,
          }
        }

        addToCart(item) {
          const itemPrice = Number(item.price)
          const itemsInCart = this.state.itemsInCart.slice()

          itemsInCart.push(item)

          this.setState({
            itemsInCart: itemsInCart,
            cartTotal: this.state.cartTotal + itemPrice,
          })
        }

        render() {
          const { itemsInCart, cartTotal } = this.state

          return (
            <div>
              <section id="products">
                <h2>Products</h2>

                <section className="product-sub-section">
                  <h3>Available fruit</h3>
                  <ul>
                    {availableProductsData.fruit.map((item) => (
                      <li key={item.product}>
                        {item.product} (${item.price}){' '}
                        <button onClick={() => this.addToCart(item)}>
                          Add +1 to cart
                        </button>
                      </li>
                    ))}
                  </ul>
                </section>

                <section className="product-sub-section">
                  <h3>Available vegetables</h3>
                  <ul>
                    {availableProductsData.vegetables.map((item) => (
                      <li key={item.product}>
                        {item.product} (${item.price}){' '}
                        <button onClick={() => this.addToCart(item)}>
                          Add +1 to cart
                        </button>
                      </li>
                    ))}
                  </ul>
                </section>
              </section>

              <section>
                <h2>Items in cart</h2>

                <p>
                  There are <span>{itemsInCart.length}</span> items in your
                  cart.
                </p>
                <div>
                  Total: $<span>{cartTotal.toFixed(2)}</span>
                </div>
              </section>
            </div>
          )
        }
      }

      const root = document.querySelector('#app-root')

      ReactDOM.render(<App />, root)
    </script>
  </body>
</html>
